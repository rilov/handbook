<blockquote>
  <p><strong>Part 1 of the Airbnb Metric Consistency Series</strong></p>

  <p><strong>Important Note:</strong> This article is based on my understanding after reading the <a href="https://medium.com/airbnb-engineering">Airbnb Engineering blog</a> and various articles about their Minerva platform. I‚Äôm trying to demystify and explain these concepts in an accessible way. If you want to understand exactly what Airbnb built, please refer to the original articles linked in the Further Reading section.</p>

  <p><strong>The surprising problem:</strong> Airbnb had world-class data infrastructure handling billions of events. But they couldn‚Äôt agree on basic numbers like ‚ÄúHow many bookings did we have yesterday?‚Äù</p>

  <p><strong>This article</strong> explains why metric inconsistency is one of the hardest problems in data ‚Äî and why it matters more than you think.</p>

  <p><strong>Next:</strong> <a href="/handbook/handbook/_topics/airbnb-metric-consistency-part-2-solution/">Part 2 - The Solution (Minerva Platform) ‚Üí</a></p>
</blockquote>

<h2 id="introduction-a-simple-question-a-hundred-answers">Introduction: A Simple Question, A Hundred Answers</h2>

<p>Imagine this scenario at an Airbnb meeting in 2018:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CEO: "How many bookings did we have last month?"

Product Manager: "500,000 bookings"
Marketing Team:   "520,000 bookings"
Finance Team:     "480,000 bookings"
Data Science:     "515,000 bookings"
Engineering:      "505,000 bookings"

CEO: "...which number is correct?"

Everyone: "Mine is!"
</code></pre></div></div>

<p><strong>This actually happened.</strong> And not just once ‚Äî it happened daily across thousands of metrics.</p>

<blockquote>
  <p><strong>Think of it like this:</strong> Imagine 5 people measuring the same room with different rulers, and each ruler shows a different length. That‚Äôs what was happening with Airbnb‚Äôs data.</p>
</blockquote>

<p>This is the story of how Airbnb fixed one of the most common (and most expensive) problems in data: <strong>metric inconsistency</strong>.</p>

<hr />

<h2 id="what-is-metric-inconsistency">What is Metric Inconsistency?</h2>

<h3 id="the-simple-explanation">The Simple Explanation</h3>

<blockquote>
  <p><strong>Metric inconsistency</strong> is when the same number means different things to different people ‚Äî or when different teams calculate the same metric in different ways.</p>
</blockquote>

<p><strong>Real example from Airbnb:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Question: "What is a 'booking'?"

Product team's definition:
‚úÖ User clicks "Book" button
‚úÖ Includes canceled bookings
Result: 520,000 bookings

Finance team's definition:
‚úÖ Payment successfully processed
‚ùå Excludes canceled bookings
Result: 480,000 bookings

Marketing team's definition:
‚úÖ User completes booking flow
‚úÖ Includes pending payments
Result: 500,000 bookings

All three are measuring "bookings"
But getting different numbers!
</code></pre></div></div>

<h3 id="why-this-happens">Why This Happens</h3>

<div class="mermaid">
flowchart TD
    START["One Concept:<br />'Bookings'"]
    
    START --&gt; TEAM1["Product Team<br />Builds Dashboard 1<br />Definition A"]
    START --&gt; TEAM2["Marketing Team<br />Builds Dashboard 2<br />Definition B"]
    START --&gt; TEAM3["Finance Team<br />Builds Dashboard 3<br />Definition C"]
    START --&gt; TEAM4["Data Science<br />Builds Model<br />Definition D"]
    
    TEAM1 --&gt; RESULT1["520,000"]
    TEAM2 --&gt; RESULT2["500,000"]
    TEAM3 --&gt; RESULT3["480,000"]
    TEAM4 --&gt; RESULT4["515,000"]
    
    style START fill:#dbeafe,stroke:#2563eb
    style RESULT1 fill:#fee,stroke:#f00
    style RESULT2 fill:#fee,stroke:#f00
    style RESULT3 fill:#fee,stroke:#f00
    style RESULT4 fill:#fee,stroke:#f00
</div>

<p><strong>What goes wrong:</strong></p>
<ol>
  <li>Each team builds their own dashboard/report</li>
  <li>Each team makes small, seemingly reasonable choices about how to calculate metrics</li>
  <li>Over time, these choices diverge</li>
  <li>Nobody notices until it‚Äôs too late</li>
</ol>

<hr />

<h2 id="the-real-cost-of-metric-inconsistency">The Real Cost of Metric Inconsistency</h2>

<h3 id="cost-1-bad-business-decisions">Cost 1: Bad Business Decisions</h3>

<blockquote>
  <p><strong>The danger:</strong> When executives see different numbers, they make decisions based on wrong data.</p>
</blockquote>

<p><strong>Real scenario:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Marketing meeting:
"Our campaign generated 50,000 bookings!" (using their definition)

Finance meeting later that day:
"Marketing spent $5M but only got 35,000 bookings" (using their definition)

CEO's conclusion:
"Marketing is terrible! Fire the CMO!"

Reality:
Both numbers were "correct" based on different definitions
But the decision to fire CMO was based on inconsistent metrics
</code></pre></div></div>

<p><strong>The cost:</strong> Billions in bad decisions.</p>

<h3 id="cost-2-wasted-engineering-time">Cost 2: Wasted Engineering Time</h3>

<blockquote>
  <p><strong>The reality:</strong> Engineers spend 50-70% of their time fixing data inconsistencies instead of building features.</p>
</blockquote>

<p><strong>A typical engineer‚Äôs week:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Monday:
"Why does our dashboard show different numbers than theirs?"
- Investigate: 4 hours
- Root cause: Different SQL query
- Fix: 2 hours

Tuesday:
"Our A/B test results don't match the experiment platform"
- Debug: 6 hours
- Root cause: Different date filters
- Fix: 2 hours

Wednesday:
"Customer support says our metrics are wrong"
- Investigate: 4 hours
- Root cause: Different timezone handling
- Fix: 2 hours

Thursday:
"CEO wants explanation for discrepancy in board deck"
- Urgent investigation: 8 hours
- Root cause: Different definition of "active user"
- Write explanation: 2 hours

Friday:
"Fix production bug"
- Actually build features: 4 hours

Total: 36 hours on metrics issues, 4 hours on features!
That's 90% of time wasted!
</code></pre></div></div>

<p><strong>At Airbnb scale:</strong></p>
<ul>
  <li>2,000+ data engineers</li>
  <li>90% time on metrics issues = 1,800 engineers wasted</li>
  <li>Cost: $360M/year in salaries alone!</li>
</ul>

<h3 id="cost-3-lost-trust-in-data">Cost 3: Lost Trust in Data</h3>

<blockquote>
  <p><strong>The death spiral:</strong> When people see inconsistent numbers, they stop trusting data altogether.</p>
</blockquote>

<p><strong>How trust dies:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Week 1:
Manager: "This dashboard shows 500K bookings"
Analyst: "Actually, this other dashboard shows 480K"
Manager: "Hmm, which is right?"

Week 5:
Manager: "These numbers don't match again"
Analyst: "Let me investigate..."
Manager: "This is getting annoying"

Week 10:
Manager: "I don't trust any of these dashboards anymore"
Analyst: "But this one is correct!"
Manager: "That's what you said about the last three..."

Week 15:
Manager: "I'll just use my gut feeling instead"
Company: *Makes decisions based on intuition, not data*

Result: $1B+ company making decisions with zero data!
</code></pre></div></div>

<h3 id="cost-4-slow-decision-making">Cost 4: Slow Decision Making</h3>

<blockquote>
  <p><strong>The bottleneck:</strong> Every meeting becomes a debate about which numbers to trust.</p>
</blockquote>

<p><strong>Before the problem is fixed:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Meeting to decide: "Should we expand to Japan?"

Hour 1: Discussing which metrics to use
- Product: "Based on our data..."
- Marketing: "No, our data shows..."
- Finance: "Actually, according to our numbers..."
- Data Science: "All your numbers are wrong..."

Hour 2: Still debating data quality
- "Why do your numbers differ from mine?"
- "Did you include canceled bookings?"
- "Which timezone are you using?"
- "Are you filtering test accounts?"

Hour 3: Finally getting somewhere
- Everyone recalculates using agreed definition
- Numbers start to align
- But meeting time is up!

Hour 4: Schedule follow-up meeting

Total meetings needed: 5-10
Time to decision: 2-3 months
Cost: Missed market opportunity
</code></pre></div></div>

<hr />

<h2 id="how-metric-inconsistency-happens">How Metric Inconsistency Happens</h2>

<h3 id="problem-1-no-single-source-of-truth">Problem 1: No Single Source of Truth</h3>

<blockquote>
  <p><strong>The issue:</strong> Every team calculates metrics independently.</p>
</blockquote>

<p><strong>Typical company structure:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Marketing Team:
‚îú‚îÄ Marketing Data Engineer
‚îú‚îÄ Writes SQL: SELECT COUNT(*) FROM bookings WHERE source='ads'
‚îú‚îÄ Creates Dashboard: "Marketing Bookings"
‚îî‚îÄ Definition lives in their code

Product Team:
‚îú‚îÄ Product Data Engineer
‚îú‚îÄ Writes SQL: SELECT COUNT(*) FROM bookings WHERE status='confirmed'
‚îú‚îÄ Creates Dashboard: "Product Bookings"
‚îî‚îÄ Definition lives in their code (different!)

Finance Team:
‚îú‚îÄ Finance Analyst
‚îú‚îÄ Writes SQL: SELECT COUNT(*) FROM bookings WHERE payment_status='paid'
‚îú‚îÄ Creates Report: "Financial Bookings"
‚îî‚îÄ Definition lives in their spreadsheet (even more different!)

Result: 3 definitions of "bookings", none documented!
</code></pre></div></div>

<h3 id="problem-2-metric-sprawl">Problem 2: Metric Sprawl</h3>

<blockquote>
  <p><strong>The issue:</strong> Metrics multiply like rabbits.</p>
</blockquote>

<p><strong>Airbnb‚Äôs metric growth:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Year 1 (2008): 10 key metrics
- Bookings, Revenue, Users, etc.
- Everyone uses same definitions
- Life is simple ‚úÖ

Year 5 (2013): 500 metrics
- Different teams create variations
- "Bookings" becomes:
  - Total Bookings
  - New Bookings
  - Repeat Bookings
  - Canceled Bookings
  - Pending Bookings
  - 50 other variations...
- Some documented, most not

Year 10 (2018): 10,000+ metrics
- Nobody knows which is the "official" metric
- Same metric has 10+ different calculations
- Data teams spend all time reconciling
- Complete chaos ‚ùå

Current state: Unsustainable
</code></pre></div></div>

<h3 id="problem-3-hidden-assumptions">Problem 3: Hidden Assumptions</h3>

<blockquote>
  <p><strong>The issue:</strong> Every metric calculation makes dozens of hidden assumptions.</p>
</blockquote>

<p><strong>Example: Calculating ‚ÄúAverage Booking Value‚Äù</strong></p>

<p>Seems simple: <code class="language-plaintext highlighter-rouge">AVG(booking_price)</code></p>

<p>But hidden questions:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. Currency?
   - USD, EUR, JPY, or local currency?
   - What exchange rate?
   - On what date?

2. Time period?
   - Booking date or check-in date?
   - UTC or local timezone?
   - Include today or not?

3. Booking status?
   - Include canceled?
   - Include pending?
   - Include refunded?
   - Include modified?

4. Booking type?
   - Include test bookings?
   - Include employee bookings?
   - Include promotional bookings?
   - Include instant book only?

5. Outliers?
   - Include $100,000 luxury mansions?
   - Include $1 promotional bookings?
   - What's the max/min?

Total combinations: 2^5 = 32+ different calculations!
All called "Average Booking Value"!
</code></pre></div></div>

<p><strong>At Airbnb:</strong> Each team made different choices, none documented.</p>

<h3 id="problem-4-lack-of-lineage-tracking">Problem 4: Lack of Lineage Tracking</h3>

<blockquote>
  <p><strong>The issue:</strong> When metrics change, nobody knows what broke downstream.</p>
</blockquote>

<p><strong>The cascade of failure:</strong></p>

<div class="mermaid">
flowchart TD
    BASE["Base Table:<br />raw_bookings"]
    
    BASE --&gt; M1["Metric 1:<br />Total Bookings<br />(used by Dashboard A)"]
    BASE --&gt; M2["Metric 2:<br />Booking Rate<br />(used by Dashboard B)"]
    
    M2 --&gt; M3["Metric 3:<br />Conversion Rate<br />(used by A/B test)"]
    M3 --&gt; M4["Metric 4:<br />ROI<br />(used by CEO dashboard)"]
    
    BASE -.-&gt;|"Someone changes<br />base table definition"| BREAK["üí•"]
    
    BREAK -.-&gt; M1
    BREAK -.-&gt; M2
    BREAK -.-&gt; M3
    BREAK -.-&gt; M4
    
    style BASE fill:#dbeafe,stroke:#2563eb
    style BREAK fill:#fee,stroke:#f00
    style M4 fill:#fee,stroke:#f00
</div>

<p><strong>What happens:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Day 1:
Data Engineer: "I'll improve the raw_bookings table"
- Changes booking_date from PST to UTC
- Seems like a good idea
- No warning systems

Day 2:
Dashboard A: Shows wrong numbers (but nobody notices yet)

Day 3:
Dashboard B: Shows wrong conversion rates
A/B test: Makes wrong decision based on bad data

Day 5:
CEO dashboard: Shows incorrect ROI
CEO: "Why did our performance tank suddenly?"
Everyone: Panic! üî•

Day 10:
After investigation:
- 47 downstream metrics were broken
- 130 dashboards showed wrong data
- 12 A/B tests made wrong decisions
- $10M in bad business decisions

Root cause: One small change, no impact tracking
</code></pre></div></div>

<h3 id="problem-5-no-version-control-for-metrics">Problem 5: No Version Control for Metrics</h3>

<blockquote>
  <p><strong>The issue:</strong> Code has Git, but metrics have nothing.</p>
</blockquote>

<p><strong>Software code (good):</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚úÖ Every change tracked in Git
‚úÖ Can see who changed what and when
‚úÖ Can roll back bad changes
‚úÖ Can review changes before deploy
‚úÖ Can see impact of changes

Example:
git log bookings.sql
- June 1: John changed filter logic
- May 15: Sarah updated timezone handling  
- May 1: Mike added new booking types
</code></pre></div></div>

<p><strong>Metrics at Airbnb (bad):</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>‚ùå No version control
‚ùå Metrics defined in various places:
   - SQL queries in dashboards
   - Python scripts on laptops
   - Spreadsheet formulas
   - Jupyter notebooks
   - Slack messages ("Just use this query")
   
‚ùå When metric changes:
   - No record of what changed
   - No record of who changed it
   - No record of why it changed
   - Can't roll back
   - Can't review

Result: Complete chaos
</code></pre></div></div>

<hr />

<h2 id="real-examples-from-airbnb">Real Examples from Airbnb</h2>

<h3 id="example-1-the-active-user-disaster">Example 1: The ‚ÄúActive User‚Äù Disaster</h3>

<p><strong>The question:</strong> ‚ÄúHow many active users do we have?‚Äù</p>

<p><strong>What happened:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Product Team definition:
- User who logged in last 30 days
- Result: 50 million active users

Growth Team definition:
- User who searched for listings last 30 days
- Result: 35 million active users

Finance Team definition:
- User who made a booking last 90 days
- Result: 20 million active users

CEO to investors:
"We have 50 million active users!"

Investors do their own analysis:
"Actually, based on Finance data, it's 20 million"

Investor: "Are you lying to us?"
CEO: "No, we just have different definitions!"
Investor: "That's even worse!"

Result: Trust destroyed, stock price drops
</code></pre></div></div>

<h3 id="example-2-the-ab-test-catastrophe">Example 2: The A/B Test Catastrophe</h3>

<p><strong>The experiment:</strong> Test new booking flow</p>

<p><strong>What happened:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Week 1: Launch A/B test
- Hypothesis: New flow will increase bookings by 10%
- Metric used: "Bookings" (Product team definition)
- Result after 1 week: +15% bookings ‚úÖ

Decision: "Ship it to 100% of users!"

Week 2: Rollout to everyone
- Marketing tracks using their "Bookings" metric
- Result: -5% bookings ‚ùå
- Marketing: "Product team broke bookings!"

Week 3: Investigation
- Product: "Our metric shows +15%"
- Marketing: "Our metric shows -5%"
- Root cause: Different definitions
  - Product counted initiated bookings (up)
  - Marketing counted completed bookings (down)
  - New flow: More initiations, fewer completions
  - Net result: Feature made things worse!

Week 4: Rollback
- Feature removed
- 2 weeks of bad user experience
- Estimated cost: $50M in lost bookings
- All because of metric inconsistency!
</code></pre></div></div>

<h3 id="example-3-the-forecasting-failure">Example 3: The Forecasting Failure</h3>

<p><strong>The goal:</strong> Forecast bookings for next quarter</p>

<p><strong>What happened:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Data Science Team:
- Builds ML model to forecast bookings
- Trains on 2 years of historical data
- Uses "bookings" from data warehouse
- Forecast: 10M bookings next quarter

Reality Check (next quarter):
- Product team: "We hit 11M bookings!"
- Marketing team: "We only got 9.5M bookings"
- Finance team: "Revenue suggests 9M bookings"

Post-mortem:
- Data Science used definition A
- Product used definition B
- Marketing used definition C
- Finance used definition D
- Model was accurate... for definition A
- But business used definition B/C/D
- Forecast appeared wrong (but wasn't!)

Result:
- CFO: "Fire the data science team!"
- Data Science: "Our forecast was correct!"
- CFO: "Then why are we missing targets?"
- Data Science: "Different definitions..."
- CFO: "This is unacceptable!"

Career impact: 3 people left the company
</code></pre></div></div>

<hr />

<h2 id="the-scale-of-the-problem">The Scale of the Problem</h2>

<h3 id="by-the-numbers-airbnb-in-2018">By the Numbers (Airbnb in 2018)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Metrics:
- 10,000+ defined metrics
- 50+ definitions of "bookings" alone
- 100+ definitions of "active user"
- 1,000+ definitions of "revenue"

Teams:
- 200+ data teams
- 2,000+ data engineers
- 5,000+ employees using data daily

Impact:
- 50-70% engineering time on reconciliation
- 100+ hours per week in "metrics meetings"
- $100M+ per year in wasted time
- $500M+ per year in bad decisions

Scalability:
- Problem grows O(N¬≤) with company size
- More teams = exponentially more inconsistency
- Unsustainable!
</code></pre></div></div>

<h3 id="the-breaking-point">The Breaking Point</h3>

<p><strong>Airbnb‚Äôs ‚ÄúOh Shit‚Äù moment (2018):</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Situation:
- Preparing for IPO
- Auditors reviewing financial metrics
- Need to certify accuracy

Auditor: "What's your 2017 revenue?"

Airbnb: "We have 5 different answers"
  - Finance: $2.6B
  - Product: $2.8B
  - Data warehouse: $2.7B
  - Tax team: $2.5B
  - CEO's dashboard: $2.9B

Auditor: "Which is correct?"

Airbnb: "Uh... all of them?"

Auditor: "I can't certify this. Fix it or no IPO."

CEO: "Drop everything. Fix this NOW."

Result: Emergency project launched
</code></pre></div></div>

<hr />

<h2 id="why-this-problem-is-universal">Why This Problem is Universal</h2>

<h3 id="its-not-just-airbnb">It‚Äôs Not Just Airbnb</h3>

<p><strong>Companies with the same problem:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Small Startup (50 employees):
- 3-5 definitions of key metrics
- Weekly arguments about numbers
- Cost: 20% of engineering time

Mid-Size Company (500 employees):
- 50-100 definitions per metric
- Daily confusion
- Cost: 40% of engineering time

Large Enterprise (5,000+ employees):
- 1,000+ definitions per metric
- Complete chaos
- Cost: 60-70% of engineering time

Every company hits this eventually!
</code></pre></div></div>

<h3 id="why-it-always-happens">Why It Always Happens</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Phase 1: Startup (0-50 people)
‚îú‚îÄ Everyone sits together
‚îú‚îÄ Informal communication works
‚îú‚îÄ One person knows all metrics
‚îî‚îÄ No problem yet ‚úÖ

Phase 2: Growth (50-200 people)
‚îú‚îÄ Teams start to specialize
‚îú‚îÄ Each team builds own dashboards
‚îú‚îÄ Small differences emerge
‚îî‚îÄ Minor annoyance üòê

Phase 3: Scale (200-1,000 people)
‚îú‚îÄ Teams in different locations
‚îú‚îÄ Can't talk to everyone
‚îú‚îÄ Metrics diverge significantly
‚îî‚îÄ Major problem üò∞

Phase 4: Enterprise (1,000+ people)
‚îú‚îÄ Multiple business units
‚îú‚îÄ Acquisitions add more systems
‚îú‚îÄ Complete metric chaos
‚îî‚îÄ Crisis! üî•

The bigger you get, the worse it gets!
</code></pre></div></div>

<hr />

<h2 id="the-traditional-solutions-that-dont-work">The Traditional ‚ÄúSolutions‚Äù (That Don‚Äôt Work)</h2>

<h3 id="failed-solution-1-lets-document-everything">Failed Solution 1: ‚ÄúLet‚Äôs Document Everything‚Äù</h3>

<p><strong>The approach:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Week 1: Create "Metrics Wiki"
- Document all 10,000 metrics
- Define each one carefully
- Get everyone to read it

Week 5: Wiki has 100 pages
- But metrics keep changing
- Documentation out of date

Week 10: Wiki has 500 pages
- Nobody reads it
- Too much text
- Still inconsistent

Result: $500K spent, zero impact ‚ùå
</code></pre></div></div>

<h3 id="failed-solution-2-lets-have-a-metrics-team">Failed Solution 2: ‚ÄúLet‚Äôs Have a Metrics Team‚Äù</h3>

<p><strong>The approach:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Hire "Metrics Team" to enforce standards

Month 1: Team defines standards
- "All metrics must use UTC"
- "All metrics must document assumptions"
- Etc.

Month 3: Nobody follows standards
- Too slow to wait for approval
- Engineers bypass the process
- Metrics team becomes bottleneck

Month 6: Metrics team overwhelmed
- 100+ requests per week
- Can't review everything
- Standards ignored

Result: Created bureaucracy, didn't solve problem ‚ùå
</code></pre></div></div>

<h3 id="failed-solution-3-lets-build-a-dashboard-tool">Failed Solution 3: ‚ÄúLet‚Äôs Build a Dashboard Tool‚Äù</h3>

<p><strong>The approach:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Build internal BI tool with "standardized metrics"

Year 1: Build tool
- $5M investment
- 20 engineers
- Looks great!

Year 2: Launch
- But... teams still use their own SQL
- Tool too rigid for custom analysis
- Adoption: 30%

Year 3: Failure
- 70% of users still use custom queries
- Tool becomes yet another source of inconsistency
- Problem actually worse (now one more tool!)

Result: $15M wasted ‚ùå
</code></pre></div></div>

<h3 id="failed-solution-4-lets-just-talk-more">Failed Solution 4: ‚ÄúLet‚Äôs Just Talk More‚Äù</h3>

<p><strong>The approach:</strong></p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"Everyone meet weekly to align on metrics"

Week 1: Meeting with 50 people
- Takes 2 hours
- Align on "bookings" definition
- Everyone agrees ‚úÖ

Week 2: Already diverging
- Product: "We need to add one small filter..."
- Marketing: "For our use case, we should..."
- Definitions drift immediately

Week 10: Back to chaos
- Nobody remembers the meeting
- Everyone has their own definition again
- Meetings become pointless

Result: 100 hours wasted per week ‚ùå
</code></pre></div></div>

<hr />

<h2 id="what-airbnb-realized">What Airbnb Realized</h2>

<h3 id="the-key-insight">The Key Insight</h3>

<blockquote>
  <p><strong>The problem isn‚Äôt people, it‚Äôs systems.</strong></p>

  <p>You can‚Äôt solve metric consistency with documentation, meetings, or teams.
You need a platform that makes inconsistency impossible.</p>
</blockquote>

<p><strong>The realization:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Old thinking:
"We need to educate people to use metrics correctly"

New thinking:
"We need to make it impossible to use metrics incorrectly"

Old approach:
- Document metrics
- Train people
- Review code
- Hope for the best

New approach:
- Define metrics once, in code
- Make everyone use the same code
- Automate verification
- Enforce consistency
</code></pre></div></div>

<h3 id="the-requirements-for-a-real-solution">The Requirements for a Real Solution</h3>

<p><strong>What Airbnb needed:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. Single Source of Truth
   ‚úÖ One place to define each metric
   ‚úÖ Everyone uses the same definition
   ‚úÖ No way to bypass it

2. Version Control
   ‚úÖ Track every change
   ‚úÖ See who, what, when, why
   ‚úÖ Roll back if needed

3. Impact Analysis
   ‚úÖ Know what breaks when you change something
   ‚úÖ Alert affected teams
   ‚úÖ Prevent accidents

4. Automatic Propagation
   ‚úÖ Change metric once
   ‚úÖ Updates everywhere automatically
   ‚úÖ No manual work

5. Testing Environment
   ‚úÖ Test changes before production
   ‚úÖ Verify correctness
   ‚úÖ Zero downtime

6. Developer Friendly
   ‚úÖ Easy to use
   ‚úÖ Fast iteration
   ‚úÖ Doesn't slow teams down
</code></pre></div></div>

<hr />

<h2 id="the-bottom-line">The Bottom Line</h2>

<h3 id="why-this-matters">Why This Matters</h3>

<p><strong>Metric consistency is not a ‚Äúnice to have‚Äù ‚Äî it‚Äôs essential for:</strong></p>

<ol>
  <li><strong>Making good decisions</strong>
    <ul>
      <li>Wrong metrics = wrong decisions</li>
      <li>Cost: Billions</li>
    </ul>
  </li>
  <li><strong>Moving fast</strong>
    <ul>
      <li>Inconsistent metrics slow everything down</li>
      <li>Cost: Opportunity cost</li>
    </ul>
  </li>
  <li><strong>Trusting data</strong>
    <ul>
      <li>Without trust, data is useless</li>
      <li>Cost: Company makes gut decisions</li>
    </ul>
  </li>
  <li><strong>Engineering productivity</strong>
    <ul>
      <li>Stop wasting time reconciling numbers</li>
      <li>Cost: 50-70% of engineering time</li>
    </ul>
  </li>
  <li><strong>IPO readiness</strong>
    <ul>
      <li>Auditors require metric consistency</li>
      <li>Cost: Can‚Äôt go public without it</li>
    </ul>
  </li>
</ol>

<h3 id="the-challenge">The Challenge</h3>

<p><strong>Building a solution is hard:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Requirements:
‚úÖ Must work at massive scale (10,000+ metrics)
‚úÖ Must be developer-friendly (or nobody uses it)
‚úÖ Must be performant (can't slow queries down)
‚úÖ Must be flexible (support all use cases)
‚úÖ Must be reliable (can't break production)

Constraints:
‚ùå Can't disrupt existing systems (too risky)
‚ùå Can't force everyone to migrate at once (impossible)
‚ùå Can't slow down teams (they'll bypass it)
‚ùå Can't be expensive to maintain (not sustainable)

Challenge: Build all this while company is rapidly growing!
</code></pre></div></div>

<hr />

<h2 id="whats-next">What‚Äôs Next?</h2>

<p>In Part 2, we‚Äôll see how Airbnb built <strong>Minerva</strong> ‚Äî a platform that solved all these problems:</p>

<p><strong>Sneak peek of the solution:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Minerva Platform:
‚îú‚îÄ Single source of truth for all metrics
‚îú‚îÄ Git-like version control
‚îú‚îÄ Automatic impact analysis
‚îú‚îÄ Staging environment for testing
‚îú‚îÄ Automatic data backfilling
‚îî‚îÄ Zero downtime updates

Results:
‚úÖ From 10,000 inconsistent metrics to 10,000 consistent metrics
‚úÖ From 70% time on reconciliation to 10%
‚úÖ From chaos to clarity
‚úÖ From blocks to IPO

Engineering time saved: 60%
Bad decisions prevented: $500M+/year
Time to implement: 2 years
</code></pre></div></div>

<p><strong>Continue to:</strong> <a href="/handbook/handbook/_topics/airbnb-metric-consistency-part-2-solution/">Part 2 - The Solution (Building Minerva) ‚Üí</a></p>

<hr />

<h2 id="summary-the-metric-consistency-crisis">Summary: The Metric Consistency Crisis</h2>

<h3 id="the-problem-in-one-picture">The Problem in One Picture</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The Question: "How many bookings yesterday?"

Before:
‚îú‚îÄ Product: 520,000
‚îú‚îÄ Marketing: 500,000
‚îú‚îÄ Finance: 480,000
‚îú‚îÄ Data Science: 515,000
‚îî‚îÄ CEO: "...which one?!"

After (with Minerva):
‚îú‚îÄ Everyone: 500,000
‚îú‚îÄ All dashboards: 500,000
‚îú‚îÄ All reports: 500,000
‚îî‚îÄ CEO: "Finally!" ‚úÖ
</code></pre></div></div>

<h3 id="key-takeaways">Key Takeaways</h3>

<ol>
  <li><strong>Metric inconsistency is the silent killer</strong>
    <ul>
      <li>Not a technical problem, a business problem</li>
      <li>Costs billions in bad decisions</li>
    </ul>
  </li>
  <li><strong>It happens to everyone</strong>
    <ul>
      <li>Small startups to big enterprises</li>
      <li>Gets worse as you grow</li>
    </ul>
  </li>
  <li><strong>Traditional solutions don‚Äôt work</strong>
    <ul>
      <li>Documentation, meetings, teams all fail</li>
      <li>Need a platform solution</li>
    </ul>
  </li>
  <li><strong>The real cost is trust</strong>
    <ul>
      <li>Without consistent metrics, data is useless</li>
      <li>Companies fall back to gut decisions</li>
    </ul>
  </li>
  <li><strong>Airbnb solved it</strong>
    <ul>
      <li>Built Minerva platform</li>
      <li>Saved 60% of engineering time</li>
      <li>Enabled IPO</li>
    </ul>
  </li>
</ol>

<p><strong>Next:</strong> Learn exactly how they did it! ‚Üí <a href="/handbook/handbook/_topics/airbnb-metric-consistency-part-2-solution/">Part 2</a></p>

<hr />

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li><strong><a href="https://medium.com/airbnb-engineering">Airbnb Engineering Blog</a></strong> - Original articles and case studies</li>
  <li><strong><a href="https://medium.com/airbnb-engineering/how-airbnb-achieved-metric-consistency-at-scale-f23cc53dea70">Original Airbnb Minerva Article</a></strong> - The source article</li>
  <li><strong><a href="https://www.oreilly.com/library/view/data-quality-at/9781492063742/">Data Quality at Scale</a></strong> - Book on data quality</li>
  <li><strong><a href="https://www.getdbt.com/blog/how-do-you-build-a-metrics-layer">dbt: Metrics as Code</a></strong> - Similar approach</li>
  <li><strong><a href="https://www.amazon.com/Data-Warehouse-Toolkit-Definitive-Dimensional/dp/1118530802">The Data Warehouse Toolkit</a></strong> - Dimensional modeling</li>
</ul>

